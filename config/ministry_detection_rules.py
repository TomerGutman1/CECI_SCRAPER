"""
Ministry Detection Rules for Israeli Government Decision Analysis

This module contains comprehensive detection rules for all 44 authorized government ministries.
Each ministry has detailed patterns for accurate identification while preventing hallucinations.

Authorized Ministries (44 total):
הוועדה לאנרגיה אטומית, הלשכה המרכזית לסטטיסטיקה, המועצה הלאומית לכלכלה, המטה לביטחון לאומי, המשרד לביטחון לאומי, המשרד להגנת הסביבה, המשרד לחדשנות מדע וטכנולוגיה, המשרד לירושלים ומורשת, המשרד לנושאים אסטרטגיים, המשרד לפיתוח הפריפריה הנגב והגליל, המשרד לשוויון חברתי, המשרד לשיתוף פעולה אזורי, הרשות לזכויות ניצולי השואה, מועצת רשות החדשנות, משרד האוצר, משרד האנרגיה, משרד הבינוי והשיכון, משרד הביטחון, משרד הבריאות, משרד הדיגיטל הלאומי, משרד הדתות, משרד החוץ, משרד החינוך, משרד החקלאות ופיתוח הכפר, משרד הכלכלה והתעשייה, משרד המודיעין, משרד המשפטים, משרד הפנים, משרד הרווחה והביטחון החברתי, משרד העלייה והקליטה, משרד התחבורה והבטיחות בדרכים, משרד התיירות, משרד התפוצות, משרד התקשורת, משרד התרבות והספורט, משרד ראש הממשלה, נציבות שוויון הזדמנויות בעבודה, נציבות שירות המדינה, ראש הממשלה, רשות האוכלוסין וההגירה, רשות החדשנות, רשות השידור, רשות המיסים בישראל
"""

from typing import Dict, List, Set, Tuple, Optional
from datetime import datetime
import re

# Ministry detection rule structure
class MinistryDetectionRule:
    def __init__(self,
                 canonical_name: str,
                 explicit_mentions: List[str],
                 implicit_indicators: List[str],
                 key_personnel: List[str],
                 decision_patterns: List[str],
                 tag_correlations: List[str],
                 common_partners: List[str],
                 exclusion_patterns: List[str],
                 historical_names: Dict[str, str] = None,
                 establishment_date: Optional[str] = None,
                 dissolution_date: Optional[str] = None):
        self.canonical_name = canonical_name
        self.explicit_mentions = explicit_mentions
        self.implicit_indicators = implicit_indicators
        self.key_personnel = key_personnel
        self.decision_patterns = decision_patterns
        self.tag_correlations = tag_correlations
        self.common_partners = common_partners
        self.exclusion_patterns = exclusion_patterns
        self.historical_names = historical_names or {}
        self.establishment_date = establishment_date
        self.dissolution_date = dissolution_date

# Comprehensive detection rules for all 44 authorized ministries
MINISTRY_DETECTION_RULES = {

    # 1. הוועדה לאנרגיה אטומית
    "הוועדה לאנרגיה אטומית": MinistryDetectionRule(
        canonical_name="הוועדה לאנרגיה אטומית",
        explicit_mentions=[
            "הוועדה לאנרגיה אטומית", "ועדת האנרגיה האטומית", "הוועדה האטומית",
            "IAEC", "Israel Atomic Energy Commission"
        ],
        implicit_indicators=[
            "אנרגיה אטומית", "כור גרעיני", "רדיואקטיבי", "קרינה", "אורניום",
            "פלוטוניום", "נאק\"א", "סורק", "דימונה", "כור מחקר"
        ],
        key_personnel=[
            "יושב ראש הוועדה לאנרגיה אטומית", "מנהל הוועדה האטומית"
        ],
        decision_patterns=[
            "רישוי מתקנים גרעיניים", "בטיחות קרינה", "פיקוח אטומי",
            "מחקר גרעיני", "רגולציה אטומית"
        ],
        tag_correlations=[
            "אנרגיה מים ותשתיות", "ביטחון לאומי וצבא", "טכנולוגיה, חדשנות ודיגיטל"
        ],
        common_partners=[
            "משרד האנרגיה", "משרד הביטחון", "משרד החדשנות מדע וטכנולוגיה"
        ],
        exclusion_patterns=[
            "אנרגיה חלופית", "אנרגיה סולארית", "אנרגיית רוח"
        ]
    ),

    # 2. הלשכה המרכזית לסטטיסטיקה
    "הלשכה המרכזית לסטטיסטיקה": MinistryDetectionRule(
        canonical_name="הלשכה המרכזית לסטטיסטיקה",
        explicit_mentions=[
            "הלשכה המרכזית לסטטיסטיקה", "למ\"ס", "לש\"מ", "הלמ\"ס",
            "CBS", "Central Bureau of Statistics", "הלשכה לסטטיסטיקה"
        ],
        implicit_indicators=[
            "מפקד אוכלוסין", "סטטיסטיקה", "נתונים דמוגרפיים", "סקר כוח אדם",
            "מדד המחירים", "תוצר מקומי גולמי", "נתונים סטטיסטיים", "דו\"ח סטטיסטי",
            "סקר הכנסות משקי בית", "מחירי דיור", "מדד יוקר המחיה"
        ],
        key_personnel=[
            "סטטיסטיקן המדינה", "מנהל הלשכה המרכזית לסטטיסטיקה"
        ],
        decision_patterns=[
            "מתודולוגיית מפקד", "פרסום נתונים סטטיסטיים", "סקר לאומי",
            "מדדים כלכליים", "דיווח סטטיסטי"
        ],
        tag_correlations=[
            "פיננסים, ביטוח ומסים", "כלכלה ותעשייה", "דיור, נדלן ותכנון"
        ],
        common_partners=[
            "משרד האוצר", "בנק ישראל", "המועצה הלאומית לכלכלה"
        ],
        exclusion_patterns=[]
    ),

    # 3. המועצה הלאומית לכלכלה
    "המועצה הלאומית לכלכלה": MinistryDetectionRule(
        canonical_name="המועצה הלאומית לכלכלה",
        explicit_mentions=[
            "המועצה הלאומית לכלכלה", "מועצה לכלכלה", "המועצה הכלכלית",
            "NEC", "National Economic Council"
        ],
        implicit_indicators=[
            "מדיניות כלכלית", "אסטרטגיה כלכלית", "תכנון כלכלי לאומי",
            "יעוץ כלכלי", "הערכות כלכליות", "צמיחה כלכלית"
        ],
        key_personnel=[
            "יושב ראש המועצה הלאומית לכלכלה", "מנהל המועצה הכלכלית"
        ],
        decision_patterns=[
            "המלצות מדיניות כלכלית", "הערכת השפעה כלכלית", "תכנון אסטרטגי כלכלי"
        ],
        tag_correlations=[
            "פיננסים, ביטוח ומסים", "כלכלה ותעשייה", "תקציב וביצועים ממשלתיים"
        ],
        common_partners=[
            "משרד האוצר", "בנק ישראל", "הלשכה המרכזית לסטטיסטיקה"
        ],
        exclusion_patterns=[]
    ),

    # 4. המטה לביטחון לאומי
    "המטה לביטחון לאומי": MinistryDetectionRule(
        canonical_name="המטה לביטחון לאומי",
        explicit_mentions=[
            "המטה לביטחון לאומי", "מטה הביטחון הלאומי", "מל\"ל",
            "NSC", "National Security Council", "המל\"ל"
        ],
        implicit_indicators=[
            "ביטחון לאומי", "הערכת מצב אסטרטגי", "מדיניות ביטחונית",
            "איומים אסטרטגיים", "תכנון ביטחוני", "מודיעין אסטרטגי"
        ],
        key_personnel=[
            "יושב ראש המטה לביטחון לאומי", "מזכיר מועצת הביטחון הלאומי"
        ],
        decision_patterns=[
            "הערכות ביטחון לאומי", "מדיניות ביטחונית", "תכנון אסטרטגי ביטחוני"
        ],
        tag_correlations=[
            "ביטחון לאומי וצבא", "דיפלומטיה ויחסים בינלאומיים"
        ],
        common_partners=[
            "משרד הביטחון", "משרד החוץ", "משרד המודיעין", "ראש הממשלה"
        ],
        exclusion_patterns=[]
    ),

    # 5. המשרד לביטחון לאומי
    "המשרד לביטחון לאומי": MinistryDetectionRule(
        canonical_name="המשרד לביטחון לאומי",
        explicit_mentions=[
            "המשרד לביטחון לאומי", "משרד הביטחון הלאומי", "משה\"ל",
            "Ministry of National Security"
        ],
        implicit_indicators=[
            "ביטחון פנימי", "ביטחון ציבורי", "ביטחון אזרחים", "ביטחון מתנחלים",
            "משמר הגבול", "מג\"ב", "כוחות הביטחון", "שמירה ואבטחה"
        ],
        key_personnel=[
            "שר הביטחון הלאומי", "מנכ\"ל המשרד לביטחון לאומי"
        ],
        decision_patterns=[
            "כוחות ביטחון אזרחיים", "רישוי נשק", "אבטחה ציבורית",
            "ביטחון תושבים", "משמר הגבול"
        ],
        tag_correlations=[
            "ביטחון לאומי וצבא", "ביטחון פנימי וסדר ציבורי"
        ],
        common_partners=[
            "משרד הביטחון", "משטרת ישראל", "המטה לביטחון לאומי"
        ],
        exclusion_patterns=[
            "צה\"ל", "חיל האוויר", "חיל הים"
        ],
        establishment_date="2022-12-29"  # Ministry established in late 2022
    ),

    # 6. המשרד להגנת הסביבה
    "המשרד להגנת הסביבה": MinistryDetectionRule(
        canonical_name="המשרד להגנת הסביבה",
        explicit_mentions=[
            "המשרד להגנת הסביבה", "משרד הסביבה", "משה\"ס", "המש\"ס",
            "Ministry of Environmental Protection", "הגנת הסביבה"
        ],
        implicit_indicators=[
            "זיהום אוויר", "איכות סביבה", "פסולת", "מיחזור", "טיפוח נוף",
            "שמורות טבע", "קיימות", "שינוי אקלים", "פחמן דו חמצני",
            "חומרים מסוכנים", "רעש", "קרינה", "מים נגרים"
        ],
        key_personnel=[
            "שר הגנת הסביבה", "מנכ\"ל המשרד להגנת הסביבה", "מנהל שירות הסביבה"
        ],
        decision_patterns=[
            "רישוי סביבתי", "פיקוח על זיהום", "תקנות סביבה",
            "הערכת השפעה סביבתית", "ניקוי זיהום"
        ],
        tag_correlations=[
            "סביבה ואקלים", "בריאות ורפואה", "אנרגיה מים ותשתיות"
        ],
        common_partners=[
            "משרד הבריאות", "רשות המים", "רשות הטבע והגנים"
        ],
        exclusion_patterns=[]
    ),

    # 7. המשרד לחדשנות מדע וטכנולוגיה
    "המשרד לחדשנות מדע וטכנולוגיה": MinistryDetectionRule(
        canonical_name="המשרד לחדשנות מדע וטכנולוגיה",
        explicit_mentions=[
            "המשרד לחדשנות מדע וטכנולוגיה", "משרד החדשנות", "משה\"ט", "המח\"ט",
            "Ministry of Innovation, Science and Technology", "חדשנות מדע וטכנולוגיה"
        ],
        implicit_indicators=[
            "חדשנות", "מדע", "טכנולוgiה", "מחקר ופיתוח", "הייטק", "סטארטאפים",
            "בינה מלאכותית", "AI", "קואליפיקציה", "אינקובטורים", "קו האופק"
        ],
        key_personnel=[
            "שר החדשנות המדע והטכנולוגיה", "מנכ\"ל המשרד לחדשנות"
        ],
        decision_patterns=[
            "תמיכה בחדשנות", "מימון מו\"פ", "תמיכה בסטארטאפים",
            "קידום מדע וטכנולוגיה", "הקמת מרכזי מצוינות"
        ],
        tag_correlations=[
            "טכנולוגיה, חדשנות ודיגיטל", "מדע ומחקר", "כלכלה ותעשייה"
        ],
        common_partners=[
            "רשות החדשנות", "מועצת רשות החדשנות", "הוועדה לאנרגיה אטומית"
        ],
        exclusion_patterns=[]
    ),

    # 8. המשרד לירושלים ומורשת
    "המשרד לירושלים ומורשת": MinistryDetectionRule(
        canonical_name="המשרד לירושלים ומורשת",
        explicit_mentions=[
            "המשרד לירושלים ומורשת", "משרד ירושלים", "המש\"י",
            "Ministry of Jerusalem and Heritage", "ירושלים ומורשת"
        ],
        implicit_indicators=[
            "ירושלים", "עיר העתיקה", "כותל מערבי", "הר הבית", "מורשת יהודית",
            "מקומות קדושים", "זהות יהודית", "ארכיאולוגיה", "מורשת תרבותית",
            "תיירות דתית"
        ],
        key_personnel=[
            "שר ירושלים והמורשת", "מנכ\"ל המשרד לירושלים ומורשת"
        ],
        decision_patterns=[
            "פיתוח ירושלים", "שימור מורשת", "תמיכה בפרויקטים בירושלים",
            "קידום זהות יהודית", "שיקום אתרי מורשת"
        ],
        tag_correlations=[
            "תרבות ומורשת", "דת ועולי נפש", "תיירות ופנוי"
        ],
        common_partners=[
            "עיריית ירושלים", "משרד התרבות והספורט", "משרד הדתות"
        ],
        exclusion_patterns=[]
    ),

    # 9. המשרד לנושאים אסטרטגיים
    "המשרד לנושאים אסטרטגיים": MinistryDetectionRule(
        canonical_name="המשרד לנושאים אסטרטגיים",
        explicit_mentions=[
            "המשרד לנושאים אסטרטגיים", "משרד הנושאים האסטרטגיים",
            "Ministry of Strategic Affairs", "נושאים אסטרטגיים"
        ],
        implicit_indicators=[
            "BDS", "האמבות", "תדמית ישראל", "מלחמת תודעה", "לגיטימציה",
            "אסטרטגיה לאומית", "דיפלומטיה ציבורית", "הסברה"
        ],
        key_personnel=[
            "שר הנושאים האסטרטגיים", "מנכ\"ל המשרד לנושאים אסטרטגיים"
        ],
        decision_patterns=[
            "מלחמה באמבות", "קידום תדמית ישראל", "מלחמה בהשמצות",
            "אסטרטגיה דיפלומטית", "פעילות הסברתית"
        ],
        tag_correlations=[
            "דיפלומטיה ויחסים בינלאומיים", "הסברה ותקשורת", "ביטחון לאומי וצבא"
        ],
        common_partners=[
            "משרד החוץ", "משרד ראש הממשלה", "המטה לביטחון לאומי"
        ],
        exclusion_patterns=[]
    ),

    # 10. המשרד לפיתוח הפריפריה הנגב והגליל
    "המשרד לפיתוח הפריפריה הנגב והגליל": MinistryDetectionRule(
        canonical_name="המשרד לפיתוח הפריפריה הנגב והגליל",
        explicit_mentions=[
            "המשרד לפיתוח הפריפריה הנגב והגליל", "משרד הנגב והגליל",
            "המשרד לפיתוח הנגב והגליל", "פיתוח הפריפריה",
            "Ministry for the Development of the Periphery, the Negev and Galilee"
        ],
        implicit_indicators=[
            "פיתוח הנגב", "פיתוח הגליל", "פריפריה", "ישובי הפריפריה",
            "חוסן לאומי", "פיזור האוכלוסייה", "עידוד התיישבות",
            "תמיכה באזורי פריפריה"
        ],
        key_personnel=[
            "שר פיתוח הפריפריה הנגב והגליל", "מנכ\"ל המשרד לפיתוח הנגב והגליל"
        ],
        decision_patterns=[
            "תמיכה באזורי פריפריה", "פיתוח כלכלי אזורי", "עידוד התיישבות",
            "חיזוק הפריפריה", "פרויקטי פיתוח אזוריים"
        ],
        tag_correlations=[
            "דיור, נדלן ותכנון", "פיתוח אזורי", "כלכלה ותעשייה"
        ],
        common_partners=[
            "משרד השיכון והבינוי", "משרד הכלכלה והתעשייה", "משרד החקלאות"
        ],
        exclusion_patterns=[]
    ),

    # 11. המשרד לשוויון חברתי
    "המשרד לשוויון חברתי": MinistryDetectionRule(
        canonical_name="המשרד לשוויון חברתי",
        explicit_mentions=[
            "המשרד לשוויון חברתי", "משרד השוויון החברתי",
            "Ministry of Social Equality", "שוויון חברתי"
        ],
        implicit_indicators=[
            "שוויון הזדמנויות", "מיעוטים", "אפליה", "שוויון מגדרי",
            "נשים", "ערבים", "חרדים", "יוצאי אתיופיה", "דרוזים",
            "צרכנים", "זכויות אדם", "שילוב חברתי"
        ],
        key_personnel=[
            "שר השוויון החברתי", "מנכ\"ל המשרד לשוויון חברתי"
        ],
        decision_patterns=[
            "קידום שוויון הזדמנויות", "מלחמה באפליה", "שילוב מיעוטים",
            "זכויות נשים", "שוויון מגדרי"
        ],
        tag_correlations=[
            "שוויון חברתי וזכויות אדם", "רווחה ושירותים חברתיים", "חינוך"
        ],
        common_partners=[
            "נציבות שוויון הזדמנויות בעבודה", "משרד הרווחה והביטחון החברתי"
        ],
        exclusion_patterns=[]
    ),

    # 12. המשרד לשיתוף פעולה אזורי
    "המשרד לשיתוף פעולה אזורי": MinistryDetectionRule(
        canonical_name="המשרד לשיתוף פעולה אזורי",
        explicit_mentions=[
            "המשרד לשיתוף פעולה אזורי", "משרד השיתוף האזורי",
            "Ministry of Regional Cooperation", "שיתוף פעולה אזורי"
        ],
        implicit_indicators=[
            "שיתוף פעולה אזורי", "שכנות טובה", "הסכמי אברהם", "נרמול",
            "שותפויות אזוריות", "מזרח התיכון", "מדינות ערב"
        ],
        key_personnel=[
            "שר השיתוף הפעולה האזורי", "מנכ\"ל המשרד לשיתוף פעולה אזורי"
        ],
        decision_patterns=[
            "קידום שיתופי פעולה אזוריים", "הסכמי שלום", "פרויקטים אזוריים",
            "שיתוף כלכלי אזורי"
        ],
        tag_correlations=[
            "דיפלומטיה ויחסים בינלאומיים", "כלכלה ותעשייה", "שלום ובטחון"
        ],
        common_partners=[
            "משרד החוץ", "משרד הכלכלה והתעשייה", "משרד ראש הממשלה"
        ],
        exclusion_patterns=[]
    ),

    # 13. הרשות לזכויות ניצולי השואה
    "הרשות לזכויות ניצולי השואה": MinistryDetectionRule(
        canonical_name="הרשות לזכויות ניצולי השואה",
        explicit_mentions=[
            "הרשות לזכויות ניצולי השואה", "רשות זכויות ניצולי השואה",
            "Authority for the Rights of Holocaust Survivors", "ניצולי שואה"
        ],
        implicit_indicators=[
            "ניצולי שואה", "שואה", "הולוקוסט", "זכרון השואה", "דור שלישי",
            "פיצויים", "קצבת ניצול שואה", "שירותי רווחה לניצולים"
        ],
        key_personnel=[
            "מנהל הרשות לזכויות ניצולי השואה", "נציב זכויות ניצולי השואה"
        ],
        decision_patterns=[
            "זכויות ניצולי שואה", "תמיכה בניצולים", "קצבאות ופיצויים",
            "שירותי רווחה לניצולים", "זכרון השואה"
        ],
        tag_correlations=[
            "רווחה ושירותים חברתיים", "תרבות ומורשת", "זכויות אדם"
        ],
        common_partners=[
            "משרד הרווחה והביטחון החברתי", "יד ושם", "משרד התרבות והספורט"
        ],
        exclusion_patterns=[]
    ),

    # 14. מועצת רשות החדשנות
    "מועצת רשות החדשנות": MinistryDetectionRule(
        canonical_name="מועצת רשות החדשנות",
        explicit_mentions=[
            "מועצת רשות החדשנות", "מועצת רח\"ד", "Innovation Authority Council"
        ],
        implicit_indicators=[
            "מועצת החדשנות", "רשות החדשנות", "הייטק", "חדשנות טכנולוגית",
            "מימון חדשנות", "תמיכה בהייטק"
        ],
        key_personnel=[
            "יושב ראש מועצת רשות החדשנות"
        ],
        decision_patterns=[
            "קביעת מדיניות חדשנות", "אישור תכניות תמיכה", "מדיניות הייטק"
        ],
        tag_correlations=[
            "טכנולוגיה, חדשנות ודיגיטל", "כלכלה ותעשייה", "מדע ומחקר"
        ],
        common_partners=[
            "רשות החדשנות", "המשרד לחדשנות מדע וטכנולוגיה"
        ],
        exclusion_patterns=[]
    ),

    # 15. משרד האוצר
    "משרד האוצר": MinistryDetectionRule(
        canonical_name="משרד האוצר",
        explicit_mentions=[
            "משרד האוצר", "מש האוצר", "אוצר", "המשאו", "MOF",
            "Ministry of Finance", "Treasury"
        ],
        implicit_indicators=[
            "תקציב", "מס", "מיסוי", "כספי מדינה", "גבייה", "המיזם הממשלתי",
            "חשב הכללי", "תקציב המדינה", "הכנסות המדינה", "חוב הלאומי",
            "בנק ישראל", "שווי חליפין", "כלכלה מאקרו"
        ],
        key_personnel=[
            "שר האוצר", "מנכ\"ל משרד האוצר", "חשב הכללי", "שלח פס החליפין"
        ],
        decision_patterns=[
            "אישור תקציב", "קביעת מסים", "הקצאות תקציביות",
            "רגולציה פיננסית", "מדיניות כלכלית"
        ],
        tag_correlations=[
            "פיננסים, ביטוח ומסים", "תקציב וביצועים ממשלתיים", "כלכלה ותעשייה"
        ],
        common_partners=[
            "בנק ישראל", "הלשכה המרכזית לסטטיסטיקה", "המועצה הלאומית לכלכלה"
        ],
        exclusion_patterns=[]
    ),

    # 16. משרד האנרגיה
    "משרד האנרגיה": MinistryDetectionRule(
        canonical_name="משרד האנרגיה",
        explicit_mentions=[
            "משרד האנרגיה", "מש האנרגיה", "האנרגיה", "משה\"א",
            "Ministry of Energy", "אנרגיה והתשתיות"
        ],
        implicit_indicators=[
            "אנרגיה", "חשמל", "דלק", "גז טבעי", "נפט", "אנרגיה מתחדשת",
            "סולארי", "רוח", "חברת החשמל", "רשות הדלק", "תחנות כוח",
            "רשת החשמל", "התייעלות אנרגטית"
        ],
        key_personnel=[
            "שר האנרגיה", "מנכ\"ל משרד האנרגיה", "רשות הדלק"
        ],
        decision_patterns=[
            "מדיניות אנרגטית", "רישוי תחנות כוח", "תעריפי חשמל",
            "רגולציה אנרגטית", "קידום אנרגיה מתחדשת"
        ],
        tag_correlations=[
            "אנרגיה מים ותשתיות", "סביבה ואקלים", "כלכלה ותעשייה"
        ],
        common_partners=[
            "חברת החשמל", "הוועדה לאנרגיה אטומית", "המשרד להגנת הסביבה"
        ],
        exclusion_patterns=[]
    ),

    # 17. משרד הבינוי והשיכון
    "משרד הבינוי והשיכון": MinistryDetectionRule(
        canonical_name="משרד הבינוי והשיכון",
        explicit_mentions=[
            "משרד הבינוי והשיכון", "משרד השיכון", "מש השיכון והבינוי",
            "משב\"ש", "Ministry of Construction and Housing", "בינוי ושיכון"
        ],
        implicit_indicators=[
            "דיור", "בינוי", "שיכון", "דירות", "מחיר למשתכן", "דיור ציבורי",
            "תכנון ובנייה", "רישוי בנייה", "תמ\"א", "פינוי בינוי",
            "התחדשות עירונית", "זכויות יוצרים", "מתן הנחה"
        ],
        key_personnel=[
            "שר הבינוי והשיכון", "מנכ\"ל משרד הבינוי והשיכון", "מנהל רשות מקרקעי ישראל"
        ],
        decision_patterns=[
            "תכניות דיור", "הקצאת מקרקעין", "רישוי בנייה",
            "מדיניות שיכון", "התחדשות עירונית"
        ],
        tag_correlations=[
            "דיור, נדלן ותכנון", "בינוי ושיכון", "עירוניות ומועצות מקומיות"
        ],
        common_partners=[
            "רשות מקרקעי ישראל", "משרד הפנים", "הוועדות המחוזיות לתכנון ובנייה"
        ],
        exclusion_patterns=[]
    ),

    # 18. משרד הביטחון
    "משרד הביטחון": MinistryDetectionRule(
        canonical_name="משרד הביטחון",
        explicit_mentions=[
            "משרד הביטחון", "מש הביטחון", "ביטחון", "מב\"ח", "MOD",
            "Ministry of Defense", "מערכת הביטחון"
        ],
        implicit_indicators=[
            "צה\"ל", "צבא", "חיל האוויר", "חיל הים", "משמר הגבול",
            "התעשייה הביטחונية", "רפא\"ל", "שב\"כ", "משרד התמ\"ת",
            "קציו\"ר", "גדעון", "רשות העתיקות"
        ],
        key_personnel=[
            "שר הביטחון", "מנכ\"ל משרד הביטחון", "מפכ\"ל", "ראש אמ\"ן"
        ],
        decision_patterns=[
            "רכש ביטחוני", "מדיניות ביטחונית", "תקציב ביטחון",
            "פיתוח ביטחוני", "הסכמי ביטחון"
        ],
        tag_correlations=[
            "ביטחון לאומי וצבא", "תעשייה ביטחונית", "מדיניות ביטחונית"
        ],
        common_partners=[
            "צה\"ל", "המטה לביטחון לאומי", "התעשייה הביטחונית"
        ],
        exclusion_patterns=[]
    ),

    # 19. משרד הבריאות
    "משרד הבריאות": MinistryDetectionRule(
        canonical_name="משרד הבריאות",
        explicit_mentions=[
            "משרד הבריאות", "מש הבריאות", "בריאות", "מב\"ר", "MOH",
            "Ministry of Health", "הבר\"י"
        ],
        implicit_indicators=[
            "בריאות", "רפואה", "בתי חולים", "כללית", "מכבי", "מאוחדת",
            "לאומית", "תרופות", "רישום תרופות", "מזון", "היגיינה",
            "מחלות זיהומיות", "חיסונים", "רדיו\"ש"
        ],
        key_personnel=[
            "שר הבריאות", "מנכ\"ל משרד הבריאות", "מנהל הרפואה", "רופא המחוז"
        ],
        decision_patterns=[
            "רישוי תרופות", "רגולציה רפואית", "מדיניות בריאות",
            "הכרה במקצועות רפואה", "רישוי מוסדות רפואה"
        ],
        tag_correlations=[
            "בריאות ורפואה", "רווחה ושירותים חברתיים", "מדע ומחקר"
        ],
        common_partners=[
            "קופות החולים", "בתי החולים", "המשרד להגנת הסביבה"
        ],
        exclusion_patterns=[]
    ),

    # 20. משרד הדיגיטל הלאומי
    "משרד הדיגיטל הלאומי": MinistryDetectionRule(
        canonical_name="משרד הדיגיטל הלאומי",
        explicit_mentions=[
            "משרד הדיגיטל הלאומי", "משרד הדיגיטל", "מדה\"ל", "מערך הדיגיטל",
            "Ministry of Digital Affairs", "דיגיטל לאומי"
        ],
        implicit_indicators=[
            "דיגיטציה", "ממשל דיגיטלי", "שירותי רשת", "אפליקציות ממשלתיות",
            "טרנספורמציה דיגיטלית", "gov.il", "מגמה דיגיטלית",
            "זהות דיגיטלית", "נגישות דיגיטלית"
        ],
        key_personnel=[
            "שר הדיגיטל הלאומי", "מנכ\"ל משרד הדיגיטל הלאומי"
        ],
        decision_patterns=[
            "דיגיטציה ממשלתית", "שירותים דיגיטליים", "מדיניות דיגיטלית",
            "נגישות דיגיטלית", "זהות דיגיטלית"
        ],
        tag_correlations=[
            "טכנולוגיה, חדשנות ודיגיטל", "שירותים ממשלתיים", "נגישות"
        ],
        common_partners=[
            "המשרד לחדשנות מדע וטכנולוגיה", "משרד ראש הממשלה"
        ],
        exclusion_patterns=[],
        establishment_date="2020-05-17"  # Ministry established in 2020
    ),

    # 21. משרד הדתות
    "משרד הדתות": MinistryDetectionRule(
        canonical_name="משרד הדתות",
        explicit_mentions=[
            "משרד הדתות", "מש הדתות", "דתות", "משה\"ד", "הדתות",
            "Ministry of Religious Services", "שירותי דת"
        ],
        implicit_indicators=[
            "שירותי דת", "רבנות", "כשרות", "חלק", "שבת", "חגים יהודיים",
            "מקוואות", "בתי כנסת", "בתי קברות", "נישואין וגירושין",
            "הלכה", "דת יהודית", "מיעוטים דתיים"
        ],
        key_personnel=[
            "שר הדתות", "מנכ\"ל משרד הדתות", "הרב הראשי", "רבני הערים"
        ],
        decision_patterns=[
            "שירותי דת", "כשרות", "נישואין דתיים", "שמירת שבת",
            "תקצוב מוסדות דת", "הכשרות דתיות"
        ],
        tag_correlations=[
            "דת ועולי נפש", "תרבות ומורשת", "שירותים חברתיים"
        ],
        common_partners=[
            "הרבנות הראשית", "בתי הדין הרבניים", "המשרד לירושלים ומורשת"
        ],
        exclusion_patterns=[]
    ),

    # 22. משרד החוץ
    "משרד החוץ": MinistryDetectionRule(
        canonical_name="משרד החוץ",
        explicit_mentions=[
            "משרד החוץ", "מש החוץ", "חוץ", "מח\"ל", "MFA",
            "Ministry of Foreign Affairs", "החוץ"
        ],
        implicit_indicators=[
            "דיפלומטיה", "שגריר", "קונסול", "יחסי חוץ", "הסכמי שלום",
            "אמנות בינלאומיות", "מדינות ערב", "אירופה", "ארה\"ב",
            "האו\"ם", "נציגות דיפלומטית", "מדיניות חוץ"
        ],
        key_personnel=[
            "שר החוץ", "מנכ\"ל משרד החוץ", "מזכיר משרד החוץ", "שגרירי ישראל"
        ],
        decision_patterns=[
            "הסכמי דיפלומטיים", "מינוי שגרירים", "יחסים דיפלומטיים",
            "מדיניות חוץ", "הסכמי סחר בינלאומיים"
        ],
        tag_correlations=[
            "דיפלומטיה ויחסים בינלאומיים", "חוץ הסברה ותפוצות", "ביטחון לאומי"
        ],
        common_partners=[
            "משרד הביטחון", "המטה לביטחון לאומי", "משרד ראש הממשלה"
        ],
        exclusion_patterns=[]
    ),

    # 23. משרד החינוך
    "משרד החינוך": MinistryDetectionRule(
        canonical_name="משרד החינוך",
        explicit_mentions=[
            "משרد החינוך", "מש החינוך", "חינוך", "מח\"ר", "MOE",
            "Ministry of Education", "הח'י"
        ],
        implicit_indicators=[
            "חינוך", "בתי ספר", "תלמידים", "מורים", "הגעה", "מתמטיקה",
            "מדע וטכנולוגיה", "STEM", "בגרות", "פסיכומטרי", "חינוך מיוחד",
            "טכנולוגיות חינוכיות", "לימודי קודש"
        ],
        key_personnel=[
            "שר החינוך", "מנכ\"ל משרד החינוך", "מנהל מחוז", "מפקחי חינוך"
        ],
        decision_patterns=[
            "תוכניות לימודים", "הכשרת מורים", "תקצוב חינוכי",
            "רפורמות חינוכיות", "בחינות ארציות"
        ],
        tag_correlations=[
            "חינוך", "נוער וילדים", "טכנולוגיה חינוכית"
        ],
        common_partners=[
            "המועצה להשכלה גבוהה", "מוסדות אקדמיים", "רשויות מקומיות"
        ],
        exclusion_patterns=[]
    ),

    # 24. משרד החקלאות ופיתוח הכפר
    "משרד החקלאות ופיתוח הכפר": MinistryDetectionRule(
        canonical_name="משרד החקלאות ופיתוח הכפר",
        explicit_mentions=[
            "משרד החקלאות ופיתוח הכפר", "משרד החקלאות", "מש החקלאות",
            "מח\"פ", "Ministry of Agriculture", "חקלאות ופיתוח הכפר"
        ],
        implicit_indicators=[
            "חקלאות", "חקלאים", "פרות", "עופות", "גידולים", "השקיה",
            "מים לחקלאות", "דגים", "יערנות", "מחוניס", "מותגי איכות",
            "פיתוח הכפר", "מושבים", "קיבוצים", "חקלאות אורגנית"
        ],
        key_personnel=[
            "שר החקלאות ופיתוח הכפר", "מנכ\"ל משרד החקלאות", "שירותי ההרשאה"
        ],
        decision_patterns=[
            "מדיניות חקלאית", "תמיכה בחקלאים", "פיתוח כפרי",
            "רגולציה חקלאית", "קידום ייצוא חקלאי"
        ],
        tag_correlations=[
            "חקלאות ופיתוח הכפר", "אנרגיה מים ותשתיות", "כלכלה ותעשייה"
        ],
        common_partners=[
            "רשות המים", "מוסדי החקלאות", "קרן קיימת לישראל"
        ],
        exclusion_patterns=[]
    ),

    # 25. משרד הכלכלה והתעשייה
    "משרד הכלכלה והתעשייה": MinistryDetectionRule(
        canonical_name="משרד הכלכלה והתעשייה",
        explicit_mentions=[
            "משרד הכלכלה והתעשייה", "משרד הכלכלה", "מש הכלכלה",
            "מכ\"ת", "Ministry of Economy", "כלכלה ותעשייה"
        ],
        implicit_indicators=[
            "תעשייה", "ייצוא", "יבוא", "מסחר חוץ", "מכסים", "תקנים",
            "חדשנות תעשייתית", "מלכ\"ר", "רישוי עסקי", "תחרות עסקית",
            "מסחר פנים", "מחירי דלק"
        ],
        key_personnel=[
            "שר הכלכלה והתעשייה", "מנכ\"ל משרד הכלכלה והתעשייה"
        ],
        decision_patterns=[
            "עידוד יצוא", "רגולציה תעשייתית", "מדיניות כלכלית",
            "תמיכה בעסקים קטנים", "יבוא וייצוא"
        ],
        tag_correlations=[
            "כלכלה ותעשייה", "מסחר וייצוא", "חדשנות עסקית"
        ],
        common_partners=[
            "משרד האוצר", "רשות החדשנות", "לשכות המסחר"
        ],
        exclusion_patterns=[]
    ),

    # 26. משרד המודיעין
    "משרד המודיעין": MinistryDetectionRule(
        canonical_name="משרד המודיעין",
        explicit_mentions=[
            "משרד המודיעין", "מש המודיעין", "מודיעין", "משמ\"ד",
            "Ministry of Intelligence", "המודיעין"
        ],
        implicit_indicators=[
            "איסוף מודיעין", "מודיעין אסטרטגי", "מודיעין ביטחוני",
            "סייבר", "מחשב מדמד", "מת\"ק", "יחידת 8200", "שירותי מודיעין"
        ],
        key_personnel=[
            "שר המודיעין", "מנכ\"ל משרד המודיעין", "ראשי שירותי המודיעין"
        ],
        decision_patterns=[
            "פעילות מודיעינית", "ביטחון מידע", "מודיעין סייבר",
            "תכנון מודיעיני", "תיאום בין ארגוני המודיעין"
        ],
        tag_correlations=[
            "ביטחון לאומי וצבא", "סייבר ומודיעין", "טכנולוגיה ביטחונית"
        ],
        common_partners=[
            "שירותי הביטחון", "המטה לביטחון לאומי", "משרד הביטחון"
        ],
        exclusion_patterns=[]
    ),

    # 27. משרד המשפטים
    "משרד המשפטים": MinistryDetectionRule(
        canonical_name="משרד המשפטים",
        explicit_mentions=[
            "משרד המשפטים", "מש המשפטים", "משפטים", "ממ\"ש", "MOJ",
            "Ministry of Justice", "הממ\"ש"
        ],
        implicit_indicators=[
            "חקיקה", "חוק", "תקנות", "בתי משפט", "שופטים", "פרקליטות",
            "פרקליט המדינה", "יועמ\"ש", "יועץ המשפטי לממשלה", "רישוי עורכי דין",
            "תביעות נזיקין", "שירות בתי הכלא", "צווי בצ\"צ"
        ],
        key_personnel=[
            "שר המשפטים", "מנכ\"ל משרד המשפטים", "יועץ המשפטי לממשלה",
            "פרקליט המדינה"
        ],
        decision_patterns=[
            "הכנת הצעות חוק", "ייעוץ משפטי לממשלה", "רישוי משפטי",
            "מדיניות חקיקה", "הגן על זכויות האזרח"
        ],
        tag_correlations=[
            "משפט, חקיקה ורגולציה", "זכויות אזרח", "מערכת המשפט"
        ],
        common_partners=[
            "היועץ המשפטי לממשלה", "פרקליטות המדינה", "בתי המשפט"
        ],
        exclusion_patterns=[]
    ),

    # 28. משרד הפנים
    "משרד הפנים": MinistryDetectionRule(
        canonical_name="משרד הפנים",
        explicit_mentions=[
            "משרד הפנים", "מש הפנים", "פנים", "מפ\"נ", "MOI",
            "Ministry of Interior", "הפנים"
        ],
        implicit_indicators=[
            "רשות מקומית", "עיריות", "מועצות", "בחירות מקומיות",
            "פיקוח פנים", "רישום תושבים", "תעודות זהות", "דרכון",
            "רישיון נהיגה", "רישוי עסקים", "מתן אזרחות"
        ],
        key_personnel=[
            "שר הפנים", "מנכ\"ל משרד הפנים", "רש\"מ", "ממונה מחוז"
        ],
        decision_patterns=[
            "פיקוח על רשויות מקומיות", "רישוי עסקי", "אזרחות והגירה",
            "בחירות מקומיות", "גבולות רשויות"
        ],
        tag_correlations=[
            "עירוניות ומועצות מקומיות", "אזרחות והגירה", "שירותים מקומיים"
        ],
        common_partners=[
            "רשות האוכלוסין וההגירה", "רשויות מקומיות", "משטרת ישראל"
        ],
        exclusion_patterns=[]
    ),

    # 29. משרד הרווחה והביטחון החברתי
    "משרד הרווחה והביטחון החברתי": MinistryDetectionRule(
        canonical_name="משרד הרווחה והביטחון החברתי",
        explicit_mentions=[
            "משרד הרווחה והביטחון החברתי", "משרד הרווחה", "מש הרווחה",
            "מר\"ח", "Ministry of Welfare", "רווחה וביטחון חברתי"
        ],
        implicit_indicators=[
            "ביטוח לאומי", "קצבאות", "תמיכת הכנסה", "שירותי רווחה",
            "טיפוח הילד", "מבוגרים מוגבלים", "משפחות מעוטות יכולת",
            "שירותי נפגעי עבירה", "זקנים", "נכים", "כמות ברווחה"
        ],
        key_personnel=[
            "שר הרווחה והביטחון החברתי", "מנכ\"ל משרד הרווחה",
            "מנכ\"ל הביטוח הלאומי"
        ],
        decision_patterns=[
            "קצבאות סוציאליות", "שירותי רווחה", "תמיכה למשפחות",
            "תמיכה בנכים", "טיפול בזקנים"
        ],
        tag_correlations=[
            "רווחה ושירותים חברתיים", "ביטוח לאומי וקצבאות", "זכויות נכים"
        ],
        common_partners=[
            "המוסד לביטוח לאומי", "השרות לילד ולנוער", "רשויות מקומיות"
        ],
        exclusion_patterns=[]
    ),

    # 30. משרד העלייה והקליטה
    "משרד העלייה והקליטה": MinistryDetectionRule(
        canonical_name="משרד העלייה והקליטה",
        explicit_mentions=[
            "משרד העלייה והקליטה", "משרד העלייה", "מש העלייה",
            "מע\"ק", "Ministry of Aliyah and Integration", "עלייה וקליטה"
        ],
        implicit_indicators=[
            "עלייה", "עולים חדשים", "קליטה", "אולפן", "למידת עברית",
            "סל קליטה", "כישורי עבודה", "הכרת תארים", "עולי אתיופיא",
            "עולי רוסיה", "עליה מארה\"ב", "זכויות עולים"
        ],
        key_personnel=[
            "שר העלייה והקליטה", "מנכ\"ל משרד העלייה והקליטה"
        ],
        decision_patterns=[
            "זכויות עולים", "סל קליטה", "תכניות הכלה", "הכרת תארים",
            "קידום שילוב עולים"
        ],
        tag_correlations=[
            "עלייה וקליטה", "חינוך ושפה עברית", "רווחה חברתית"
        ],
        common_partners=[
            "הסוכנות היהודית", "משרד החינוך", "משרד הרווחה והביטחון החברתי"
        ],
        exclusion_patterns=[]
    ),

    # 31. משרד התחבורה והבטיחות בדרכים
    "משרד התחבורה והבטיחות בדרכים": MinistryDetectionRule(
        canonical_name="משרד התחבורה והבטיחות בדרכים",
        explicit_mentions=[
            "משרד התחבורה והבטיחות בדרכים", "משרד התחבורה", "מש התחבורה",
            "מת\"ב", "Ministry of Transport", "תחבורה ובטיחות בדרכים"
        ],
        implicit_indicators=[
            "תחבורה ציבורית", "אוטובוס", "רכבת", "מונית", "רישיון נהיגה",
            "בטיחות בדרכים", "תאונות דרכים", "נתב\"ג", "תעופה אזרחית",
            "נמלים", "משאיות", "רכב פרטי", "נתיבי איילון"
        ],
        key_personnel=[
            "שר התחבורה והבטיחות בדרכים", "מנכ\"ל משרד התחבורה",
            "מנהל רשות התעופה האזרחית"
        ],
        decision_patterns=[
            "מדיניות תחבורה", "רישוי תחבורה", "בטיחות בדרכים",
            "תכנון תשתיות", "הסדרת תחבורה ציבורית"
        ],
        tag_correlations=[
            "תחבורה ובטיחות בדרכים", "תשתיות", "בטיחות ציבורית"
        ],
        common_partners=[
            "משטרת ישראל", "חברות התחבורה הציבורית", "רשות שדות התעופה"
        ],
        exclusion_patterns=[]
    ),

    # 32. משרד התיירות
    "משרד התיירות": MinistryDetectionRule(
        canonical_name="משרד התיירות",
        explicit_mentions=[
            "משרד התיירות", "מש התיירות", "תיירות", "מת'י", "התיירות",
            "Ministry of Tourism"
        ],
        implicit_indicators=[
            "תיירות", "מלונות", "נופש", "אתרי תיירות", "מדריכי תיירות",
            "תיירים", "אינפול", "עתיקות", "מורשת תיירותית", "תיירות דתית",
            "תיירות נטרנמית", "הידור תיירות"
        ],
        key_personnel=[
            "שר התיירות", "מנכ\"ל משרד התיירות", "מנהל רשות העתיקות"
        ],
        decision_patterns=[
            "פיתוח תיירות", "שיקום אתרים", "רישוי מלונות",
            "תמיכה בתיירות", "פרסום תיירותי"
        ],
        tag_correlations=[
            "תיירות ופנוי", "תרבות ומורשת", "כלכלה מקומית"
        ],
        common_partners=[
            "רשות העתיקות", "רשות הטבע והגנים", "המשרד לירושלים ומורשת"
        ],
        exclusion_patterns=[]
    ),

    # 33. משרד התפוצות
    "משרד התפוצות": MinistryDetectionRule(
        canonical_name="משרד התפוצות",
        explicit_mentions=[
            "משרד התפוצות", "מש התפוצות", "תפוצות", "מתפ\"ו", "התפוצות",
            "Ministry of Diaspora Affairs", "עניני תפוצות"
        ],
        implicit_indicators=[
            "תפוצות יהודיות", "יהדות העולם", "קהילות יהודיות", "אנטישמיות",
            "קשר עם התפוצות", "חינוך יהודי", "זהות יהודית", "מזמז\"ש",
            "תגלית", "יהדות ארה\"ב", "יהדות אירופה"
        ],
        key_personnel=[
            "שר התפוצות", "מנכ\"ל משרד התפוצות"
        ],
        decision_patterns=[
            "קשר עם יהדות העולם", "מלחמה באנטישמיות", "חינוך יהודי",
            "קידום הקשר לישראל", "תמיכה בקהילות יהודיות"
        ],
        tag_correlations=[
            "חוץ הסברה ותפוצות", "תרבות יהודית", "דיפלומטיה ציבורית"
        ],
        common_partners=[
            "משרד החוץ", "הסוכנות היהודית", "הקרן לישראל"
        ],
        exclusion_patterns=[]
    ),

    # 34. משרד התקשורת
    "משרד התקשורת": MinistryDetectionRule(
        canonical_name="משרד התקשורת",
        explicit_mentions=[
            "משרד התקשורת", "מש התקשורת", "תקשורת", "מתק\"ש", "התקשורת",
            "Ministry of Communications"
        ],
        implicit_indicators=[
            "רדיו", "טלוויזיה", "שידור", "בזק", "סלולר", "אינטרנט",
            "תדרים", "רדיופה", "גלי צה\"ל", "רשות השידור", "זכיות שידור",
            "שיעיל", "משד\"ר", "טלפום", "פרטמור"
        ],
        key_personnel=[
            "שר התקשורת", "מנכ\"ל משרד התקשורת", "מנכ\"ל רשות השידור"
        ],
        decision_patterns=[
            "הקצאת תדרים", "רישוי שידור", "רגולציית תקשורת",
            "מדיניות תקשורת", "פיקוח על חברות התקשורת"
        ],
        tag_correlations=[
            "תקשורת ומדיה", "טכנולוגיות תקשורת", "רגולציה תקשורתית"
        ],
        common_partners=[
            "רשות השידור", "חברות התקשורת", "רשות התקשורת"
        ],
        exclusion_patterns=[]
    ),

    # 35. משרד התרבות והספורט
    "משרד התרבות והספורט": MinistryDetectionRule(
        canonical_name="משרד התרבות והספורט",
        explicit_mentions=[
            "משרד התרבות והספורט", "משרד התרבות", "מש התרבות",
            "מת\"ס", "Ministry of Culture and Sport", "תרבות וספורט"
        ],
        implicit_indicators=[
            "תרבות", "אמנות", "תיאטרון", "מוזיאון", "ספרייה", "ספורט",
            "אתלטיקה", "מכבי", "הפועל", "ליגת העל", "נבחרת ישראל",
            "אומנויות", "מחול", "מוזיקה", "קולנוע"
        ],
        key_personnel=[
            "שר התרבות והספורט", "מנכ\"ל משרד התרבות והספורט"
        ],
        decision_patterns=[
            "תמיכה באמנויות", "פיתוח תרבותי", "תמיכה בספורט",
            "מוסדות תרבות", "אירועי ספורט"
        ],
        tag_correlations=[
            "תרבות ומורשת", "ספורט ופעילות גופנית", "אמנויות"
        ],
        common_partners=[
            "המועצה לתרבות ולאמנות", "הוועדה האולימפית", "מוסדות תרבות"
        ],
        exclusion_patterns=[]
    ),

    # 36. משרד ראש הממשלה
    "משרד ראש הממשלה": MinistryDetectionRule(
        canonical_name="משרד ראש הממשלה",
        explicit_mentions=[
            "משרד ראש הממשלה", "מש ראש הממשלה", "ראש הממשלה", "רה\"מ",
            "PMO", "Prime Minister Office", "משרד רה\"מ"
        ],
        implicit_indicators=[
            "ראש הממשלה", "בנימין נתניהו", "רה\"מ", "לשכת ראש הממשלה",
            "מדיניות ממשלתית", "קבינט", "מזכירות הממשלה", "סמך ממשלה",
            "פרלמנט זר", "תיאום ממשלתי", "מזכיר הממשלה"
        ],
        key_personnel=[
            "ראש הממשלה", "מזכיר הממשלה", "מנכ\"ל משרד ראש הממשלה"
        ],
        decision_patterns=[
            "קביעת מדיניות ממשלתית", "תיאום בין-משרדי", "החלטות קבינט",
            "ניהול לשכת ראש הממשלה", "מתן הנחיות ממשלתיות"
        ],
        tag_correlations=[
            "ניהול ממשלתי", "מדיניות ממשלתית", "תיאום ממשלתי"
        ],
        common_partners=[
            "כל משרדי הממשלה", "מזכירות הממשלה", "הכנסת"
        ],
        exclusion_patterns=[]
    ),

    # 37. נציבות שוויון הזדמנויות בעבודה
    "נציבות שוויון הזדמנויות בעבודה": MinistryDetectionRule(
        canonical_name="נציבות שוויון הזדמנויות בעבודה",
        explicit_mentions=[
            "נציבות שוויון הזדמנויות בעבודה", "נציבות שוויון זדמנויות",
            "נציבות שה\"ז", "Equal Employment Opportunity Commission"
        ],
        implicit_indicators=[
            "שוויון בעבודה", "אפליה בעבודה", "הטרדה מינית", "זכויות עובדים",
            "שוויון הזדמנויות", "נשים בעבודה", "מיעוטים בעבודה",
            "גזענות", "אפליה גילאי", "זכויות נכים בעבודה"
        ],
        key_personnel=[
            "נציב שוויון הזדמנויות בעבודה", "מנהל נציבות שוויון הזדמנויות"
        ],
        decision_patterns=[
            "טיפול בתלונות אפליה", "קידום שוויון בעבודה", "רגולציה נגד אפליה",
            "חקירת תלונות", "מלחמה באפליה"
        ],
        tag_correlations=[
            "שוויון חברתי וזכויות אדם", "עבודה ותעסוקה", "זכויות עובדים"
        ],
        common_partners=[
            "משרד הכלכלה והתעשייה", "המשרד לשוויון חברתי", "ארגוני עובדים"
        ],
        exclusion_patterns=[]
    ),

    # 38. נציבות שירות המדינה
    "נציבות שירות המדינה": MinistryDetectionRule(
        canonical_name="נציבות שירות המדינה",
        explicit_mentions=[
            "נציבות שירות המדינה", "נציבות שה\"מ", "נש\"מ",
            "Civil Service Commission", "שירות המדינה"
        ],
        implicit_indicators=[
            "עובדי מדינה", "שירות ציבורי", "גיוס לשירות המדינה",
            "תנאי שירות", "קדמא", "דרגה", "ועדת קיהדמ", "תחו\"ש",
            "הכשרת עובדים", "שכר עובדי מדינה"
        ],
        key_personnel=[
            "נציב שירות המדינה", "סגן נציב שירות המדינה"
        ],
        decision_patterns=[
            "גיוס עובדי מדינה", "קביעת תנאי שירות", "הכשרת עובדים",
            "דיני ממדינה", "מדיניות משאבי אנוש"
        ],
        tag_correlations=[
            "ניהול משאבי אנוש", "שירות ציבורי", "ממשל וביורוקרטיה"
        ],
        common_partners=[
            "כל משרדי הממשלה", "ארגוני עובדים", "משרד האוצר"
        ],
        exclusion_patterns=[]
    ),

    # 39. ראש הממשלה
    "ראש הממשלה": MinistryDetectionRule(
        canonical_name="ראש הממשלה",
        explicit_mentions=[
            "ראש הממשלה", "רה\"מ", "Prime Minister", "PM",
            "בנימין נתניהו", "נתניהו"
        ],
        implicit_indicators=[
            "ראש הממשלה", "רה\"מ", "הנהגת המדינה", "מנהיג ישראל",
            "לשכת ראש הממשלה", "ראש הממשלה בפעיה"
        ],
        key_personnel=[
            "ראש הממשלה", "בנימין נתניהו"
        ],
        decision_patterns=[
            "הנהגה לאומית", "קביעת מדיניות עליונה", "הובלת הממשלה",
            "ייצוג המדינה", "החלטות אסטרטגיות"
        ],
        tag_correlations=[
            "הנהגה לאומית", "מדיניות ממשלתית", "ניהול המדינה"
        ],
        common_partners=[
            "משרד ראש הממשלה", "כל משרדי הממשלה"
        ],
        exclusion_patterns=[]
    ),

    # 40. רשות האוכלוסין וההגירה
    "רשות האוכלוסין וההגירה": MinistryDetectionRule(
        canonical_name="רשות האוכלוסין וההגירה",
        explicit_mentions=[
            "רשות האוכלוסין וההגירה", "רשות האוכלוסין", "רא\"ה",
            "Population and Immigration Authority", "אוכלוסין והגירה"
        ],
        implicit_indicators=[
            "תעודת זהות", "דרכון", "אזרחות", "התאמזרחות", "רישום אוכלוסין",
            "הגירה", "מעמד שהייה", "ויזה", "רישום לידה", "רישום נישואין",
            "רישום פטירה", "רישום גירושין"
        ],
        key_personnel=[
            "מנהל רשות האוכלוסין וההגירה", "ראש רשות האוכלוסין"
        ],
        decision_patterns=[
            "הנפקת מסמכי זיהוי", "רישום נתוני אוכלוסין", "הסדרת מעמד",
            "מתן אזרחות", "פיקוח על הגירה"
        ],
        tag_correlations=[
            "אזרחות והגירה", "תיעוד ורישום", "זהות ומסמכים"
        ],
        common_partners=[
            "משרד הפנים", "משרד העלייה והקליטה", "משטרת ישראל"
        ],
        exclusion_patterns=[]
    ),

    # 41. רשות החדשנות
    "רשות החדשנות": MinistryDetectionRule(
        canonical_name="רשות החדשנות",
        explicit_mentions=[
            "רשות החדשנות", "רח\"ד", "Innovation Authority",
            "Israel Innovation Authority", "הרשות לחדשנות"
        ],
        implicit_indicators=[
            "מימון חדשנות", "הייטק", "סטארטאפים", "מחקר ופיתוח",
            "אינקובטורים", "מצוינות טכנולוגית", "בינה מלאכותית",
            "קואליצית נגל", "נתע\"ל", "אקסלרטורים"
        ],
        key_personnel=[
            "מנכ\"ל רשות החדשנות", "יו\"ר רשות החדשנות"
        ],
        decision_patterns=[
            "מימון פרויקטי חדשנות", "תמיכה בסטארטאפים", "פיתוח הייטק",
            "תכניות תמיכה טכנולוגיות", "קידום חדשנות"
        ],
        tag_correlations=[
            "טכנולוגיה, חדשנות ודיגיטל", "מדע ומחקר", "כלכלה ותעשייה"
        ],
        common_partners=[
            "המשרד לחדשנות מדע וטכנולוגיה", "מועצת רשות החדשנות", "התעשייה הישראלית"
        ],
        exclusion_patterns=[]
    ),

    # 42. רשות השידור
    "רשות השידור": MinistryDetectionRule(
        canonical_name="רשות השידור",
        explicit_mentions=[
            "רשות השידור", "רש\"ש", "Broadcasting Authority",
            "Israel Broadcasting Authority", "הרשות לשידור"
        ],
        implicit_indicators=[
            "שידורי רדיו", "שידורי טלוויזיה", "ערוץ 1", "רדיו ישראל",
            "גלי צה\"ל", "רשת ב'", "מוזיקה ישראלית", "חדשות",
            "תוכניות רדיו", "תוכניות טלוויזיה"
        ],
        key_personnel=[
            "מנכ\"ל רשות השידור", "מנהל רדיו ישראל", "מנהל הטלוויזיה החינוכית"
        ],
        decision_patterns=[
            "מדיניות שידור", "תוכן שידורים", "רישוי שידורים",
            "פיקוח על שידור", "ליקון ותכניות"
        ],
        tag_correlations=[
            "תקשורת ומדיה", "שידור ציבורי", "תרבות ומוזיקה"
        ],
        common_partners=[
            "משרד התקשורת", "רשות התקשורת", "הממונה על השידור"
        ],
        exclusion_patterns=[]
    ),

    # 43. רשות המיסים בישראל
    "רשות המיסים בישראל": MinistryDetectionRule(
        canonical_name="רשות המיסים בישראל",
        explicit_mentions=[
            "רשות המיסים בישראל", "רשות המיסים", "רמ\"י", "מס הכנסה",
            "Israel Tax Authority", "רשם\"י"
        ],
        implicit_indicators=[
            "מס הכנסה", "מס ערך מוסף", "מע\"ם", "ביטוח לאומי", "מיסים",
            "גבייה", "שומה", "דו\"ח שנתי", "מרואה חשבון", "רכב משרדי",
            "מחליפין", "פנקסי חשבון", "מהמו"
        ],
        key_personnel=[
            "מנהל רשות המיסים", "מ שמרו, מנהל מס הכנסה"
        ],
        decision_patterns=[
            "גביית מיסים", "קביעת שיעורי מס", "פיקוח מיסואה",
            "הטבות מס", "מלחמה בהעלמות מס"
        ],
        tag_correlations=[
            "פיננסים, ביטוח ומסים", "גבייה ואכיפה", "רגולציה פיננסית"
        ],
        common_partners=[
            "משרד האוצר", "המוסד לביטוח לאומי", "בנק ישראל"
        ],
        exclusion_patterns=[]
    ),

    # 44. היועץ המשפטי לממשלה
    "היועץ המשפטי לממשלה": MinistryDetectionRule(
        canonical_name="היועץ המשפטי לממשלה",
        explicit_mentions=[
            "היועץ המשפטי לממשלה", "יועץ המשפטי לממשלה", "יועמ\"ש",
            "Attorney General", "היועמ\"ש"
        ],
        implicit_indicators=[
            "ייעוץ משפטי", "פרקליטות המדינה", "דעת משפטית", "הלכה משפטית",
            "בג\"ץ", "עליון", "חוק יסוד", "חוקתיות", "כשרות החלטות",
            "סגן יועמ\"ש", "כחיקונית"
        ],
        key_personnel=[
            "היועץ המשפטי לממשלה", "סגן יועץ משפטי לממשלה"
        ],
        decision_patterns=[
            "מתן דעות משפטיות", "ייעוץ חוקתי", "פיקוח על חוקיות",
            "ייצוג המדינה בבג\"ץ", "בדיקת חוקיות החלטות"
        ],
        tag_correlations=[
            "משפט, חקיקה ורגולציה", "חוקתיות", "ייעוץ משפטי"
        ],
        common_partners=[
            "משרד המשפטים", "בתי המשפט", "פרקליטות המדינה"
        ],
        exclusion_patterns=[]
    )

}


def get_ministry_by_name(name: str) -> Optional[MinistryDetectionRule]:
    """Get ministry detection rule by name."""
    return MINISTRY_DETECTION_RULES.get(name)

def get_all_canonical_names() -> List[str]:
    """Get all canonical ministry names."""
    return list(MINISTRY_DETECTION_RULES.keys())

def get_ministries_by_tag(tag: str) -> List[str]:
    """Get ministries that correlate with a specific tag."""
    result = []
    for canonical_name, rule in MINISTRY_DETECTION_RULES.items():
        if tag in rule.tag_correlations:
            result.append(canonical_name)
    return result

def get_ministry_partners(ministry_name: str) -> List[str]:
    """Get common partners for a ministry."""
    rule = MINISTRY_DETECTION_RULES.get(ministry_name)
    return rule.common_partners if rule else []

def validate_ministry_for_date(ministry_name: str, decision_date: str) -> bool:
    """Check if ministry existed at the decision date."""
    rule = MINISTRY_DETECTION_RULES.get(ministry_name)
    if not rule:
        return False

    if rule.establishment_date:
        try:
            decision_dt = datetime.strptime(decision_date, "%Y-%m-%d").date()
            establishment_dt = datetime.strptime(rule.establishment_date, "%Y-%m-%d").date()
            if decision_dt < establishment_dt:
                return False
        except ValueError:
            pass  # Skip validation if date parsing fails

    if rule.dissolution_date:
        try:
            decision_dt = datetime.strptime(decision_date, "%Y-%m-%d").date()
            dissolution_dt = datetime.strptime(rule.dissolution_date, "%Y-%m-%d").date()
            if decision_dt > dissolution_dt:
                return False
        except ValueError:
            pass  # Skip validation if date parsing fails

    return True

# Historical ministry name changes
MINISTRY_HISTORICAL_CHANGES = {
    "2020-05-17": {
        "added": ["משרד הדיגיטל הלאומי"],
        "renamed": {},
        "removed": []
    },
    "2022-12-29": {
        "added": ["המשרד לביטחון לאומי"],
        "renamed": {},
        "removed": []
    }
}

def get_historical_ministry_name(name: str, date: str) -> Optional[str]:
    """Get historical ministry name for a specific date."""
    # This would implement historical name resolution
    # For now, return the canonical name if it exists
    return name if name in MINISTRY_DETECTION_RULES else None

# Export main detection rules
__all__ = [
    'MINISTRY_DETECTION_RULES',
    'MinistryDetectionRule',
    'get_ministry_by_name',
    'get_all_canonical_names',
    'get_ministries_by_tag',
    'get_ministry_partners',
    'validate_ministry_for_date',
    'get_historical_ministry_name'
]